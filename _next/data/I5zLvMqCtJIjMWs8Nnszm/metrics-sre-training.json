{"pageProps":{"title":"Lecture Notes for Metrics - A Short, Practical Primer","hast":{"type":"root","children":[{"type":"element","tagName":"h1","properties":{"id":"outline"},"children":[{"type":"text","value":"Outline"}]},{"type":"element","tagName":"h2","properties":{"id":"first-principles"},"children":[{"type":"text","value":"First Principles"}]},{"type":"element","tagName":"h3","properties":{"id":"what-is-a-metric"},"children":[{"type":"text","value":"what is a metric"}]},{"type":"element","tagName":"h4","properties":{"id":"in-terms-of-data"},"children":[{"type":"text","value":"in terms of data"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"it is a label, a number and a timestamp. so, a time-indexed kv pair.  some other details about the number can be kept for fun sometimes. \n"}]},{"type":"element","tagName":"h4","properties":{"id":"in-terms-of-use"},"children":[{"type":"text","value":"in terms of use"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"it is a single piece of information you want to have about a \"running\" \"system\" ie. anything that you can measure, the output of the measurement is a metric.\n"}]},{"type":"element","tagName":"h4","properties":{"id":"in-terms-of-why"},"children":[{"type":"text","value":"in terms of \"why\""}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"well,  "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"the scientific method."}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"debugging something? have a target to meet? need to know how to provision a resource? need to know if you're "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"wasting"}]},{"type":"text","value":" a resource?\nmetrics to the rescue! find a way to\n"}]},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"quantify your targets\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"measure your world\n"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"and you have the panaceaic answers to all your questions!\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"(further reading: "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"How to Measure Anything"}]},{"type":"text","value":", Douglas Hubbard)\n"}]},{"type":"element","tagName":"h3","properties":{"id":"data-challenges"},"children":[{"type":"text","value":"data challenges"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":" collection and storage timestamps, how do they work storage optimization\n"}]},{"type":"element","tagName":"h3","properties":{"id":"use-challenges"},"children":[{"type":"text","value":"use challenges"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"querying and analysis cardinality size bucketing: the ultimate shitty tradeoff between storage and analysis requirements\n"}]},{"type":"element","tagName":"h3","properties":{"id":"motivation-challenges"},"children":[{"type":"text","value":"motivation challenges"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"measuring irrelevant things\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"bad labeling\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"nothing is more irritating than rewriting five labels that ought to have been one label at query time.\n"}]}]}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"treating "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"documents"}]}]},{"type":"text","value":" and "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"metrics"}]}]},{"type":"text","value":" as the same\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"cardinality makes a difference.\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"measurement collection and storage is not the same as analysis-artifact caching. Unix principle - small purposeful tools.\n"}]}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"use cases:\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"debugging\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"how to investigate a problem given a set of metrics?\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"what ought you be "},{"type":"element","tagName":"span","properties":{"className":["underline"],"style":"text-decoration: underline;"},"children":[{"type":"text","value":"always"}]},{"type":"text","value":" collecting in case you need to investigate something?\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"\"system\" metrics - trying to measure the function of all the critical pieces of an OS\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"\"success\" metrics - is the thing I want to happen, happening?\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"\"uptime\" usually tracks the history of these\n"}]}]}]}]}]}]}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"alerting\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"\"success\" metrics are the zeroth alert.\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"\"is this working?\" tests.\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"sometimes the answer is on a spectrum, which means you decide on "},{"type":"element","tagName":"span","properties":{"className":["underline"],"style":"text-decoration: underline;"},"children":[{"type":"text","value":"thresholds"}]},{"type":"text","value":" to divide the spectrum into black and white. (or green, orange, and yellow, if you like to pretend you care about an orange alert.)\n"}]}]}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"the reactionary flow of alert setting\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"something went drastically wrong\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"it turns out it was due to a certain \"bad behaviour\"\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"let's alert that bad behaviour so that we catch the next time that goes wrong\n"}]}]}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"strive to do better\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"catch frequent offenders\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"identify first principles\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"reactionary alerts are bandaids. try hard to fix the deeper problem.\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"always have a way to remember what you created an alert "},{"type":"element","tagName":"span","properties":{"className":["underline"],"style":"text-decoration: underline;"},"children":[{"type":"text","value":"for"}]},{"type":"text","value":".\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"DOCUMENT.\n"}]}]}]}]}]}]}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"profiling\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"making stuff better.\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"have a target: \"X endpoint needs to respond in Y ms at the Zth percentile\".\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"find out how to measure the target.\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"figure out what correlates with the target\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"stare at graphs of stuff you're already collecting\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"make theories about what's happening and figure out how to falsify them\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"collect new data as needed\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"LABEL WELL\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"if there is a standardised way to collect the data you need, USE IT.\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"if there isn't, well, collect it in as ad hoc a way as you like, but write a note in a wiki that you've done that\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"AND LABEL THE DATA INFORMATIVELY.\n"}]}]}]}]}]}]}]}]}]}]}]},{"type":"element","tagName":"h2","properties":{"id":"system-metrics"},"children":[{"type":"text","value":"System metrics"}]},{"type":"element","tagName":"h2","properties":{"id":"collectd"},"children":[{"type":"text","value":"Collectd"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"get them to install collectd show them what it collects\n"}]},{"type":"element","tagName":"h2","properties":{"id":"graphite"},"children":[{"type":"text","value":"Graphite"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"somebody else gotta step in to discuss; pls no practical.\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"a graphite endpoint they can push to and navigate to the dashboard of?\n"}]},{"type":"element","tagName":"h3","properties":{"id":"whisperdb"},"children":[{"type":"text","value":"whisperdb"}]},{"type":"element","tagName":"h3","properties":{"id":"carbon-relay"},"children":[{"type":"text","value":"carbon-relay"}]},{"type":"element","tagName":"h3","properties":{"id":"carbon-ng-or-something-the-go-rewrite"},"children":[{"type":"text","value":"carbon-ng? or something the go rewrite"}]},{"type":"element","tagName":"h2","properties":{"id":"prometheus"},"children":[{"type":"text","value":"Prometheus"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"wouldn't minda practical here. prom is smol.\n"}]},{"type":"element","tagName":"h3","properties":{"id":"promtsdb-"},"children":[{"type":"text","value":"promtsdb "}]},{"type":"element","tagName":"h3","properties":{"id":"pull-based-arch-and-the-consequences"},"children":[{"type":"text","value":"pull-based arch (and the consequences)"}]},{"type":"element","tagName":"h4","properties":{"id":"exporters"},"children":[{"type":"text","value":"exporters"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"get them to install node exporter\n"}]},{"type":"element","tagName":"h3","properties":{"id":"prom-web-endpoint-"},"children":[{"type":"text","value":"prom web endpoint "}]},{"type":"element","tagName":"h3","properties":{"id":"alertmanager"},"children":[{"type":"text","value":"alertmanager"}]},{"type":"element","tagName":"h4","properties":{"id":"alerting-rules"},"children":[{"type":"text","value":"alerting rules"}]},{"type":"element","tagName":"h2","properties":{"id":"grafana"},"children":[{"type":"text","value":"Grafana"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"unified graphs and queries frontend originally mostly for graphite but it can talk to EVERYTHING muhahahaha somewhat heavy webapp tho\n"}]},{"type":"element","tagName":"h3","properties":{"id":"dashboard"},"children":[{"type":"text","value":"dashboard"}]},{"type":"element","tagName":"h3","properties":{"id":"panel"},"children":[{"type":"text","value":"panel"}]},{"type":"element","tagName":"h3","properties":{"id":"panel-query-editing"},"children":[{"type":"text","value":"panel query editing"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"useful walkthrough here to discuss how and why to use various display features\n"}]},{"type":"element","tagName":"h1","properties":{"id":"duncan-method-informed-class-structure"},"children":[{"type":"text","value":"Duncan method informed class structure"}]},{"type":"element","tagName":"h2","properties":{"id":"core-skill"},"children":[{"type":"text","value":"Core skill"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"measure a system.\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"create or find metrics\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"collect metrics\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"install and use metrics collectors\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"collectd\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"what else?\n"}]}]}]}]}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"collate metrics\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"ask useful questions of metrics\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"know which questions are worth asking and when\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"taxonomy of questions\n"}]}]}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"know how to construct a given question in statspeak\n"}]}]}]}]}]}]}]}]},"filetags":{},"backlinks":[{"path":"/all_pages","title":"All Pages"}]},"__N_SSG":true}